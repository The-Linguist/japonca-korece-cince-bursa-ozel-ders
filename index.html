<html lang="tr" dir="ltr">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="icon" href="logo.png" type="image/png" sizes="512x512">
    <title>JAPONCA - Bursa Özel Ders</title>
    <meta name="description" content="bursa japonca kursu, japonca dil kursu, japonca özel ders">
    <link rel="stylesheet" href="ilk_ekran.css">
    <script src="ua-parser.min.js"></script>
    <script>
      if ("serviceWorker" in navigator) {  window.addEventListener("DOMContentLoaded",()=>{  navigator.serviceWorker.register("service-worker.js");  });  }
    </script>

    <!-- Google tag (gtag.js) GOOGLE ADS -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-11021503070"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'AW-11021503070');
    </script>

    <!-- Event snippet for Giden tıklama conversion page
    In your html page, add the snippet and call gtag_report_conversion when someone clicks on the chosen link or button. -->
    <script>
    function gtag_report_conversion() {
      gtag('event', 'conversion', {
          'send_to': 'AW-11021503070/JlE2CIuCg4IYEN6Uu4cp'
      });
      return false;
    }
    </script>


  </head>
  <body>
    <iframe src=""></iframe>
    <main>
      <div class="dropShadow">
        <img src="beykagan_hoca.webp">
      </div>
      <div class="mesajIcerenDiv dropShadow">
        <p>Beykağan Hoca Bursa'da her seviye için yüzyüze Japonca (日本語) dersleri veriyor; daha fazla bilgi almak ve eğer istersen ders talebi oluşturmak için</p>
        <div class="" style="text-align:center;">
          <button class="button-30" role="button">TANITIM VİDEOSU İZLE</button>
          <!-- <button style="text-align:center; font-size: 11px; padding-left: 1ch; padding-right: 1ch;" role="button" disabled>Korece<br>한국어</button>&nbsp;&nbsp;&nbsp;&nbsp; -->
          <!-- <button style="text-align:center; font-size: 11px; padding-left: 1ch; padding-right: 1ch;" role="button" disabled>Çince<br>華語</button> -->
        </div>
      </div>
    </main>
    <script type="text/javascript">
      var isApple = false;
      var parser = new UAParser();
      var result = parser.getResult();
      console.log(result.browser.name);
      console.log(result.os.name);
      //---
      const main = document.getElementsByTagName('main')[0];
      const freym = document.getElementsByTagName('iframe')[0];
      //var geriSayim;
      let zamanDoldu30s = false;
      let zamanDoldu15s = false;
      let buttonWasUsed = false;
      window.addEventListener("load",startBgLoop);
      function startBgLoop() {
        async function loadFiles () {
          const myCache1 = await caches.open('my-cache-1');
          const myCache2 = await caches.open('my-cache-2');
          const myCache3 = await caches.open('my-cache-3');
          const firstGroup = ['bg/1.webp', 'bg/2.webp','bg/3.webp','bg/4.webp','bg/5.webp','bg/6.webp','bg/7.webp','bg/8.webp'];
          const secondGroup = ['hitoca_poster.jpg'];
          var thirdGroup;
          if (result.os.name == "Mac OS" || result.os.name == "iOS") {
            thirdGroup = ['hitoca.mp4'];
          } else {
            thirdGroup = ['hitoca.webm'];
          }
          try {
            await myCache1.addAll(firstGroup);
          } catch(err) {
            console.error(err);
          } finally {
            console.log("cache1 done");
            var counter = 0;
            img1 = document.createElement("IMG"); img1.onload = function () { counter++; checkHowMany(); }; img1.src = "bg/1.webp";
            img2 = document.createElement("IMG"); img2.onload = function () { counter++; checkHowMany(); }; img2.src = "bg/2.webp";
            img3 = document.createElement("IMG"); img3.onload = function () { counter++; checkHowMany(); }; img3.src = "bg/3.webp";
            img4 = document.createElement("IMG"); img4.onload = function () { counter++; checkHowMany(); }; img4.src = "bg/4.webp";
            img5 = document.createElement("IMG"); img5.onload = function () { counter++; checkHowMany(); }; img5.src = "bg/5.webp";
            img6 = document.createElement("IMG"); img6.onload = function () { counter++; checkHowMany(); }; img6.src = "bg/6.webp";
            img7 = document.createElement("IMG"); img7.onload = function () { counter++; checkHowMany(); }; img7.src = "bg/7.webp";
            img8 = document.createElement("IMG"); img8.onload = function () { counter++; checkHowMany(); }; img8.src = "bg/8.webp";
            function checkHowMany() {
              if (counter == 8) {
                setTimeout(function () {  main.style.animationName = "changeBg";  }, 100);
                setTimeout(function () {  main.style.animationDuration = "41s";  }, 1111);
              }
            }
            await myCache2.addAll(secondGroup);
            console.log("cache2 as well");
            await myCache3.addAll(thirdGroup);
            console.log("cache3 too");
            if (zamanDoldu30s) {
              console.log("It took more than 30s to cache the video\nNavigate quickly");
              setTimeout(function () {
                if (!buttonWasUsed) {
                  console.log("...and the button still was not used");
                  goToVideo();
                }
              }, 15000);
            } else if (zamanDoldu15s) {
              console.log("It took more than 15s to cache the video\nWill wait 30s before navigating");
              setTimeout(function () {
                if (!buttonWasUsed) {
                  console.log("...and the button still was not used");
                  goToVideo();
                }
              }, 30000);
            } else {
              console.log("video loaded quickly in less than 15s\nWill wait 45s before navigating");
              setTimeout(function () {
                if (!buttonWasUsed) {
                  console.log("...and the button still was not used");
                  goToVideo();
                }
              }, 45000);
            }
          }
        }
        loadFiles();

        function goToVideo() {
          console.log("going to video page due to timeout");
          freym.src = "japonca.html";
          setTimeout(function () {
            main.style.display = "none";
          }, 500);
          gtag_report_conversion(); // Madem ki video cache'ye yazılacak kadar beklemiş, bunu da dönüşüm sayalım
        }
        // After 30 seconds go to video even if button is not clicked
        setTimeout(function () {
          zamanDoldu30s=true;
        }, 30000);
        setTimeout(function () {
          zamanDoldu15s=true;
        }, 15000);
      }


      const secimJaponca = document.getElementsByTagName('button')[0];
      // const secimKorece = document.getElementsByTagName('button')[1];
      // const secimCince = document.getElementsByTagName('button')[2];
      secimJaponca.addEventListener("mouseup",hitocaHtmlYukle);
      function hitocaHtmlYukle() {
        console.log("going to video page because button was pressed\ncache timeout will be ignored");
        buttonWasUsed = true;
        freym.src = "japonca.html";
        setTimeout(function () {
          main.style.display = "none";
        }, 500);
        gtag_report_conversion();
        // if (geriSayim) {          clearTimeout(geriSayim);        }
      }
      /*
      secimKorece.addEventListener("mouseup",koreceHtmlYukle);
      function koreceHtmlYukle() {
        gtag_report_conversion();
        freym.src = "korece.html";
        setTimeout(function () {
          main.style.display = "none";
        }, 500);
      }
      */
    </script>
  </body>
</html>
